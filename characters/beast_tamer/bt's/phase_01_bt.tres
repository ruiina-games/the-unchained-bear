[gd_resource type="BehaviorTree" load_steps=38 format=3 uid="uid://c2gr4a0ig0ujm"]

[ext_resource type="Script" path="res://ai/tasks/conditions/check_distance.gd" id="1_d83ie"]
[ext_resource type="Script" path="res://ai/tasks/play_tree_anim.gd" id="1_jdqnl"]
[ext_resource type="Script" path="res://ai/tasks/random_attack.gd" id="2_1gm2q"]
[ext_resource type="Script" path="res://ai/tasks/beast tameress/move.gd" id="2_mgrc0"]
[ext_resource type="Script" path="res://ai/tasks/attack_inform.gd" id="4_qpdct"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_2k351"]
var/consecutive_hits/name = &"consecutive_hits"
var/consecutive_hits/type = 2
var/consecutive_hits/value = 0
var/consecutive_hits/hint = 0
var/consecutive_hits/hint_string = ""
var/move_target/name = &"move_target"
var/move_target/type = 24
var/move_target/hint = 0
var/move_target/hint_string = ""
var/can_move/name = &"can_move"
var/can_move/type = 1
var/can_move/value = false
var/can_move/hint = 0
var/can_move/hint_string = ""
var/is_dead/name = &"is_dead"
var/is_dead/type = 1
var/is_dead/value = false
var/is_dead/hint = 0
var/is_dead/hint_string = ""

[sub_resource type="BBVariant" id="BBVariant_a3yx3"]
type = 1
saved_value = false
resource_name = "false"

[sub_resource type="BTCheckVar" id="BTCheckVar_p03q8"]
variable = &"can_move"
value = SubResource("BBVariant_a3yx3")

[sub_resource type="BTAction" id="BTAction_liinw"]
custom_name = "Stun"
script = ExtResource("1_jdqnl")
animation_condition = &"idle"

[sub_resource type="BTSequence" id="BTSequence_nnnfv"]
custom_name = "Stunned"
children = [SubResource("BTCheckVar_p03q8"), SubResource("BTAction_liinw")]

[sub_resource type="BBVariant" id="BBVariant_ad8bv"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_3obbr"]
variable = &"is_dead"
value = SubResource("BBVariant_ad8bv")

[sub_resource type="BTAction" id="BTAction_cfxoc"]
custom_name = "Die"
script = ExtResource("1_jdqnl")
animation_condition = &"death"

[sub_resource type="BTSequence" id="BTSequence_7y3pg"]
custom_name = "Death"
children = [SubResource("BTCheckVar_3obbr"), SubResource("BTAction_cfxoc")]

[sub_resource type="BTCondition" id="BTCondition_y8bbx"]
custom_name = "Is enemy close enough to kick?"
script = ExtResource("1_d83ie")
target_distance = 600.0
check_mode = 1

[sub_resource type="BTAction" id="BTAction_3hq8c"]
custom_name = "Perform Kick"
script = ExtResource("1_jdqnl")
animation_condition = &"kick"

[sub_resource type="BTDelay" id="BTDelay_7e5dn"]
seconds = 0.4
custom_name = "Attack Inform"
children = [SubResource("BTAction_3hq8c")]
script = ExtResource("4_qpdct")
inform_text = "BEAST TAMERESS IS GOING TO KICK"

[sub_resource type="BTSequence" id="BTSequence_wbvid"]
custom_name = "Kick"
children = [SubResource("BTCondition_y8bbx"), SubResource("BTDelay_7e5dn")]

[sub_resource type="BTSelector" id="BTSelector_smtbu"]
custom_name = "Close Enemy or Consecutive Hits Selection"
children = [SubResource("BTSequence_wbvid")]

[sub_resource type="BTCooldown" id="BTCooldown_hm7qn"]
duration = 2.0
custom_name = "Kick Cooldown"
children = [SubResource("BTSelector_smtbu")]

[sub_resource type="BTAction" id="BTAction_agp5m"]
custom_name = "Idle animation while waiting for delay to fisnih"
script = ExtResource("1_jdqnl")
animation_condition = &"idle"

[sub_resource type="BTCondition" id="BTCondition_acvpi"]
script = ExtResource("1_d83ie")
target_distance = 1200.0
check_mode = 2

[sub_resource type="BTInvert" id="BTInvert_rsoop"]
children = [SubResource("BTCondition_acvpi")]

[sub_resource type="BTDelay" id="BTDelay_2qism"]
seconds = 0.5
custom_name = "Anti-sliding delay (without it boss is starting moving too early after attack)"
children = [SubResource("BTInvert_rsoop")]

[sub_resource type="BTAction" id="BTAction_ep575"]
custom_name = "Play Run Animation"
script = ExtResource("1_jdqnl")
animation_condition = &"run"

[sub_resource type="BTAction" id="BTAction_e77kh"]
script = ExtResource("2_mgrc0")
move_speed = 650.0
tolerance = 25.0
should_stop_at_enemy = true

[sub_resource type="BTAction" id="BTAction_ympc1"]
custom_name = "Play Idle Animation"
script = ExtResource("1_jdqnl")
animation_condition = &"idle"

[sub_resource type="BTSequence" id="BTSequence_7r6ke"]
custom_name = "Movement Sequence"
children = [SubResource("BTAction_agp5m"), SubResource("BTDelay_2qism"), SubResource("BTAction_ep575"), SubResource("BTAction_e77kh"), SubResource("BTAction_ympc1")]

[sub_resource type="BTCooldown" id="BTCooldown_h1fli"]
duration = 2.0
custom_name = "Movement Cooldown"
children = [SubResource("BTSequence_7r6ke")]

[sub_resource type="BTCondition" id="BTCondition_31app"]
custom_name = "Is enemy far enough to hit him?"
script = ExtResource("1_d83ie")
target_distance = 700.0
check_mode = 0

[sub_resource type="BTAction" id="BTAction_vm3vn"]
script = ExtResource("2_1gm2q")
available_attacks = 3

[sub_resource type="BTDelay" id="BTDelay_txoqq"]
seconds = 0.4
custom_name = "Delay for attack inform to display"
children = [SubResource("BTAction_vm3vn")]
script = ExtResource("4_qpdct")
inform_text = "BEAT TAMERESS IS GOING TO ATTACK"

[sub_resource type="BTSequence" id="BTSequence_qiqji"]
custom_name = "Attack 1 Sequence"
children = [SubResource("BTCondition_31app"), SubResource("BTDelay_txoqq")]

[sub_resource type="BTCooldown" id="BTCooldown_ufa2x"]
duration = 3.0
custom_name = "Attack 1 Cooldown"
children = [SubResource("BTSequence_qiqji")]

[sub_resource type="BTAction" id="BTAction_e6in2"]
custom_name = "Play Idle Animation"
script = ExtResource("1_jdqnl")
animation_condition = &"idle"

[sub_resource type="BTSequence" id="BTSequence_ce3no"]
custom_name = "Idle"
children = [SubResource("BTAction_e6in2")]

[sub_resource type="BTSelector" id="BTSelector_3u446"]
children = [SubResource("BTSequence_nnnfv"), SubResource("BTSequence_7y3pg"), SubResource("BTCooldown_hm7qn"), SubResource("BTCooldown_h1fli"), SubResource("BTCooldown_ufa2x"), SubResource("BTSequence_ce3no")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_2k351")
root_task = SubResource("BTSelector_3u446")
